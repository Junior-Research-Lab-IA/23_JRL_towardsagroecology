pattern_fill    = 'black',
pattern_colour  = 'black'
)
ggplot(Data, aes(x=Treatment,y=Stability,fill=Year_Stability))+geom_boxplot_pattern(
aes(pattern =Year_Stability),
fill            = 'white',
colour          = 'black',
pattern_density = 0.35,
pattern_fill    = 'black',
pattern_colour  = 'black'
) +geom_text(data=Valuemax_TrtStb, aes(x=Treatment, y=0.1+max_value, label=SigLetter_TrtStb$groups),vjust=1)+ ggtitle("Soil Stability")+theme(plot.title = element_text(hjust = 0.5),legend.position="bottom")
ggplot(Data, aes(x=Treatment,y=Stability,fill=Year_Stability))+geom_boxplot_pattern(
aes(pattern =Year_Stability),
fill            = 'white',
colour          = 'black',
pattern_density = 0.35,
pattern_fill    = 'black',
pattern_colour  = 'black'
) + ggtitle("Soil Stability")+theme(plot.title = element_text(hjust = 0.5),legend.position="bottom")
P1=ggplot(Data, aes(x=Treatment,y=Stability,fill=Year_Stability))+geom_boxplot_pattern(
aes(pattern =Year_Stability),
fill            = 'white',
colour          = 'black',
pattern_density = 0.35,
pattern_fill    = 'black',
pattern_colour  = 'black'
)
P2= P1++geom_text(data=Valuemax_TrtStb, aes(x=Treatment, y=0.1+max_value, label=SigLetter_TrtStb$groups),vjust=1)+ ggtitle("Soil Stability")+theme(plot.title = element_text(hjust = 0.5),legend.position="bottom")
P2= P1+geom_text(data=Valuemax_TrtStb, aes(x=Treatment, y=0.1+max_value, label=SigLetter_TrtStb$groups),vjust=1)+ ggtitle("Soil Stability")+theme(plot.title = element_text(hjust = 0.5),legend.position="bottom")
P2
ggplot(Data, aes(x=Treatment, y=Stability,fill=Year_Stability))+ geom_boxplot_pattern()+geom_text(data=Valuemax_TrtStb, aes(x=Treatment, y=0.1+max_value, label=SigLetter_TrtStb$groups),vjust=1)+ ggtitle("Soil Stability")+theme(plot.title = element_text(hjust = 0.5),legend.position="bottom")
ggplot(Data, aes(x=Treatment, y=Stability,fill=Year_Stability))+ geom_boxplot()+geom_text(data=Valuemax_TrtStb, aes(x=Treatment, y=0.1+max_value, label=SigLetter_TrtStb$groups),vjust=1)+ ggtitle("Soil Stability")+theme(plot.title = element_text(hjust = 0.5),legend.position="bottom")
str(Data)
Bulk=Data%>%
select (Treatment,Block,Plot,Rep,Bulk_Stability,Bulk_Density, Depth)%>%
arrange(Year_Stability, Treatment)%>%
na.omit()
Bulk=Data%>%
select (Treatment,Block,Plot,Rep,Year_Bulk,Bulk_Density, Depth)%>%
arrange(Year_Stability, Treatment)%>%
na.omit()
Bulk=Data%>%
select (Treatment,Block,Plot,Rep,Year_Bulk,Bulk_Density, Depth)%>%
arrange(Year_Bulk, Treatment)%>%
na.omit()
Ano_Bulk= aov(Stability~Treatment+Year_Stability+Depth+Treatment*Year_Stability+Block+Plot, data=Bulk)
Ano_Bulk= aov(Bulk_Density~Treatment+Year_Stability+Depth+Treatment*Year_Bulk+Block+Plot, data=Bulk)
Ano_Bulk= aov(Bulk_Density~Treatment+Year_Bulk+Depth+Treatment*Year_Bulk+Block+Plot, data=Bulk)
anova(Ano_Stb)
anova(Ano_Bulk)
Bulk_Year= LSD.test(Ano_Bulk,"Year_Stability")
Bulk_Year
Bulk_Year= LSD.test(Ano_Bulk,"Year_Bulk")
Bulk_Year
Bulk_Trt= LSD.test(Ano_Bulk,"Treatment")
Bulk_Trt
Bulk_Block= LSD.test(Ano_Bulk,"Block")
Bulk_Block
LSD_Test_Bulk= LSD.test(Ano_Bulk, c("Treatment", "Year_Bulk"))
LSD_Test_Bulk
Bulk=Data%>%
select (Treatment,Block,Plot,Rep,Year_Bulk,Bulk_Density, Depth)%>%
arrange(Year_Bulk, Treatment)%>%
na.omit()
Ano_Bulk= aov(Bulk_Density~Treatment+Year_Bulk+Depth+Treatment*Year_Bulk+Block+Plot, data=Bulk)
anova(Ano_Bulk)
Bulk_Year= LSD.test(Ano_Bulk,"Year_Bulk")
Bulk_Year
Bulk_Trt= LSD.test(Ano_Bulk,"Treatment")
Bulk_Trt
Bulk_Block= LSD.test(Ano_Bulk,"Block")
Bulk_Block
LSD_Test_Bulk= LSD.test(Ano_Bulk, c("Treatment", "Year_Bulk"))
LSD_Test_Bulk
Valuemax_Bulk=Bulk%>%
group_by(Treatment,Year_Bulk)%>%
summarize(max_value=max(Bulk))
Valuemax_Bulk=Bulk%>%
group_by(Treatment,Year_Bulk_Density)%>%
summarize(max_value=max(Bulk))
Valuemax_Bulk=Bulk%>%
group_by(Treatment,Year_Bulk)%>%
summarize(max_value=max(Bulk_Density))
SigLetter_Bulk = LSD_Test_Bulk$groups  %>%
group_by(rownames(LSD_Test_Bulk$groups)) %>%
arrange(rownames(LSD_Test_Bulk$groups))
ggplot(Data, aes(x=Treatment, y=Bulk_Density,fill=Year_Bulk))+ geom_boxplot()+geom_text(data=Valuemax_Bulk, aes(x=Treatment, y=0.1+max_value, label=SigLetter_Bulk$groups),vjust=1)+ ggtitle("Soil Stability in 2019 and 2023")+theme(plot.title = element_text(hjust = 0.5),legend.position="bottom")
ggplot(Data, aes(x=Treatment, y=Bulk_Density,fill=Year_Bulk))+ geom_boxplot()+geom_text(data=Valuemax_Bulk, aes(x=Treatment, y=0.1+max_value, label=SigLetter_Bulk$groups))+ ggtitle("Soil Stability in 2019 and 2023")+theme(plot.title = element_text(hjust = 0.5),legend.position="bottom")
ggplot(Data, aes(x=Treatment, y=Bulk_Density,fill=Year_Bulk))+ geom_boxplot()+geom_text(data=Valuemax_Bulk, aes(x=Treatment, y=0.1+max_value, label=SigLetter_Bulk$groups),vjust=0)+ ggtitle("Soil Stability in 2019 and 2023")+theme(plot.title = element_text(hjust = 0.5),legend.position="bottom")
ggplot(Data, aes(x=Treatment, y=Bulk_Density,fill=Year_Bulk))+ geom_boxplot()+geom_text(data=Valuemax_Bulk, aes(x=Treatment, y=0.1+max_value, label=SigLetter_Bulk$groups),vjust=-3)+ ggtitle("Soil Stability in 2019 and 2023")+theme(plot.title = element_text(hjust = 0.5),legend.position="bottom")
ggplot(Data, aes(x=Treatment, y=Bulk_Density,fill=Year_Bulk))+ geom_boxplot()+geom_text(data=Valuemax_Bulk, aes(x=Treatment, y=0.1+max_value, label=SigLetter_Bulk$groups),vjust=5)+ ggtitle("Soil Stability in 2019 and 2023")+theme(plot.title = element_text(hjust = 0.5),legend.position="bottom")
ggplot(Data, aes(x=Treatment, y=Bulk_Density,fill=Year_Bulk))+ geom_boxplot()+geom_text(data=Valuemax_Bulk, aes(x=Treatment, y=0.1+max_value, label=SigLetter_Bulk$groups),vjust=3)+ ggtitle("Soil Stability in 2019 and 2023")+theme(plot.title = element_text(hjust = 0.5),legend.position="bottom")
ggplot(Data, aes(x=Treatment, y=Bulk_Density,fill=Year_Bulk))+ geom_boxplot()+geom_text(data=Valuemax_Bulk, aes(x=Treatment, y=0.1+max_value, label=SigLetter_Bulk$groups),vjust=2)+ ggtitle("Soil Stability in 2019 and 2023")+theme(plot.title = element_text(hjust = 0.5),legend.position="bottom")
ggplot(Data, aes(x=Treatment, y=Bulk_Density,fill=Year_Bulk))+ geom_boxplot()+geom_text(data=Valuemax_Bulk, aes(x=Treatment, y=0.1+max_value, label=SigLetter_Bulk$groups),position = position_dodge(width = 0.9),vjust = -(0.5))+ ggtitle("Soil Stability in 2019 and 2023")+theme(plot.title = element_text(hjust = 0.5),legend.position="bottom")
ggplot(Data, aes(x=Treatment, y=Stability,fill=Year_Stability))+ geom_boxplot()+geom_text(data=Valuemax_TrtStb, aes(x=Treatment, y=0.1+max_value, label=SigLetter_TrtStb$groups),position = position_dodge(width = 0.9),vjust = -(0.5)))+ ggtitle("Soil Stability in 2019 and 2023")+theme(plot.title = element_text(hjust = 0.5),legend.position="bottom")
ggplot(Data, aes(x=Treatment, y=Stability,fill=Year_Stability))+ geom_boxplot()+geom_text(data=Valuemax_TrtStb, aes(x=Treatment, y=0.1+max_value, label=SigLetter_TrtStb$groups),position = position_dodge(width = 0.9),vjust = -(0.5))+ ggtitle("Soil Stability in 2019 and 2023")+theme(plot.title = element_text(hjust = 0.5),legend.position="bottom")
ggplot(Data, aes(x=Treatment, y=Bulk_Density,fill=Year_Bulk))+ geom_boxplot()+geom_text(data=Valuemax_Bulk, aes(x=Treatment, y=0.1+max_value, label=SigLetter_Bulk$groups),position = position_dodge(width = 0.9),vjust = -(0.5))+ ggtitle("Bulk Density in 2019 and 2023")+theme(plot.title = element_text(hjust = 0.5),legend.position="bottom")
str(Data)
Data$Bulk_Density=Data$Bulk
X= Data %>%
select (-Treatment,-Variety,-Direction,-Block,-Plot,-Rep,-Year_Stability,-Year_CN,-Year_Bulk,-Depth)
ggpairs(X)
View(X)
View(X)
View(Data)
View(Data)
X= Data %>%
select (-c[1:10])
X= Data %>%
select(1:10)
View(X)
X= Data %>%
select(11:24)
View(X)
X= Data %>%
select(10:24)
View(X)
View(X)
View(X)
setwd("C:/Users/melis/OneDrive - Universiti Putra Malaysia/Documents/GitHub/23_JRL_towardsagroecology")
Data <- read_csv("SALSADataset.csv", col_types = cols(Treatment = col_factor(levels = c())))
Data$Year_Stability=as.factor(Data$Year_Stability)
Data$Year_CN=as.factor(Data$Year_CN)
Data$Year_Bulk=as.factor(Data$Year_CN)
str(Data)
View(Data)
View(Data)
X= Data %>%
select(11:25)
ggpairs(X)
Cor.Stb_Bulk <- cor.test(X$Bulk_Density, X$Stability, method = "pearson")
Cor.Stb_Bulk
ggplot(Data, aes(y = Stability, x = Treatment)) +
geom_boxplot()
plot_grid(
ggplot(Data, aes(y = Stability, x = Treatment)) +
geom_boxplot(),
ggplot(Data, aes(y = Stability , x = TotalOM)) + geom_point(),
ggplot(Data, aes(y = Stability, x = TotalN)) + geom_point(),
ggplot(Data, aes(y = Stability, x = CN))
+ geom_point(),
ggplot(Data, aes(y = Stability, x = Cmin))
+ geom_point(),
ggplot(Data, aes(y = Stability, x = NO3 ))
+ geom_point(),
ggplot(Data, aes(y = Stability, x = NH4)) + geom_point(),
ggplot(Data, aes(y = Stability, x = Nmin_Drysoil)) +
geom_point(),
ggplot(Data, aes(y = Stability, x = Nmin )) +
geom_point(),
ggplot(Data, aes(y = Stability, x = humidity)) +
geom_point(),
nrow =5, ncol = 2)
Data%>%
na.omit()
plot_grid(
ggplot(Data, aes(y = Stability, x = Treatment)) +
geom_boxplot(),
ggplot(Data, aes(y = Stability , x = TotalOM)) + geom_point(),
ggplot(Data, aes(y = Stability, x = TotalN)) + geom_point(),
ggplot(Data, aes(y = Stability, x = CN))
+ geom_point(),
ggplot(Data, aes(y = Stability, x = Cmin))
+ geom_point(),
ggplot(Data, aes(y = Stability, x = NO3 ))
+ geom_point(),
ggplot(Data, aes(y = Stability, x = NH4)) + geom_point(),
ggplot(Data, aes(y = Stability, x = Nmin_Drysoil)) +
geom_point(),
ggplot(Data, aes(y = Stability, x = Nmin )) +
geom_point(),
ggplot(Data, aes(y = Stability, x = humidity)) +
geom_point(),
nrow =5, ncol = 2)
ggplot(Data, aes(y = Stability , x = TotalOM)) + geom_point()
ggplot(Data, aes(y = Stability, x = TotalN)) + geom_point()
View(Data)
View(Data)
str(Data)
Stability_model=Data%>%
select(-Direction,-Variety,-Year_CN,-Year_Bulk,-Depth)%>%
na.omit()%>%
group_by(Treatment,Block,Year_Stability)%>%
summarise(Stability= mean(Stability),TotalOM=mean(TotalOM),TotalN=mean(TotalN),CN= mean(CN),Cmin=mean(Cmin),`Cmin%`=mean(`Cmin%`), NH4=mean(NH4), NO3= mean(NO3_T0), Nmin_Drysoil=mean(Nmin),`Nmin%`=mean(`Nmin%`), humidity=mean(humidity), F_Mechanical=mean(`F_Mechanical actions`), soiltx=mean(DG_soilTx),`Stone:soil`=mean(`Stone:soil`) )
Stability_model=Data%>%
select(-Direction,-Variety,-Year_CN,-Year_Bulk,-Depth)%>%
na.omit()%>%
group_by(Treatment,Block,Year_Stability)%>%
summarise(Stability= mean(Stability),TotalOM=mean(TotalOM),TotalN=mean(TotalN),CN= mean(CN),Cmin=mean(Cmin),`Cmin%`=mean(`Cmin%`), NH4=mean(NH4), NO3= mean(NO3), Nmin_Drysoil=mean(Nmin),`Nmin%`=mean(`Nmin%`), humidity=mean(humidity), F_Mechanical=mean(`F_Mechanical actions`), soiltx=mean(DG_soilTx),`Stone:soil`=mean(`Stone:soil`) )
str(Stability_model)
Stability_model=Data%>%
select(-Direction,-Variety,-Year_CN,-Year_Bulk,-Depth)%>%
na.omit()%>%
group_by(Treatment,Block,Year_Stability)%>%
summarise(Stability= mean(Stability),bulk=mean(Bulk_Density),TotalOM=mean(TotalOM),TotalN=mean(TotalN),CN= mean(CN),Cmin=mean(Cmin),`Cmin%`=mean(`Cmin%`), NH4=mean(NH4), NO3= mean(NO3), Nmin_Drysoil=mean(Nmin),`Nmin%`=mean(`Nmin%`), humidity=mean(humidity), F_Mechanical=mean(`F_Mechanical actions`), soiltx=mean(DG_soilTx),`Stone:soil`=mean(`Stone:soil`) )
str(Stability_model)
ggpairs(Stability_model)
Stability_model=Data%>%
select(-Direction,-Variety,-Year_CN,-Year_Bulk,)%>%
na.omit()%>%
group_by(Treatment,Block,Year_Stability,Depth)%>%
summarise(Stability= mean(Stability),bulk=mean(Bulk_Density),TotalOM=mean(TotalOM),TotalN=mean(TotalN),CN= mean(CN),Cmin=mean(Cmin),`Cmin%`=mean(`Cmin%`), NH4=mean(NH4), NO3= mean(NO3), Nmin_Drysoil=mean(Nmin),`Nmin%`=mean(`Nmin%`), humidity=mean(humidity), F_Mechanical=mean(`F_Mechanical actions`), soiltx=mean(DG_soilTx),`Stone:soil`=mean(`Stone:soil`) )
View(Stability_model)
View(Stability_model)
Y=Data%>%
-select(1:4)
Y=Data%>%
select(5:15)
View(Y)
View(Y)
Stability_model=>%
Stability_model=Data%>%
select(-Direction,-Variety,-Year_CN,-Year_Bulk,)%>%
na.omit()%>%
group_by(Treatment,Block,Year_Stability,Depth)%>%
summarise(Stability= mean(Stability),bulk=mean(Bulk_Density),TotalOM=mean(TotalOM),TotalN=mean(TotalN),CN= mean(CN),Cmin=mean(Cmin),`Cmin%`=mean(`Cmin%`), NH4=mean(NH4), NO3= mean(NO3), Nmin_Drysoil=mean(Nmin),`Nmin%`=mean(`Nmin%`), humidity=mean(humidity), F_Mechanical=mean(`F_Mechanical actions`), soiltx=mean(DG_soilTx),`Stone:soil`=mean(`Stone:soil`) )
Stability_model=>%
Stability_model%>%
select(5:15)
Y=Stability_model%>%
select(5:15)
View(Y)
View(Y)
View(Stability_model)
View(Stability_model)
Y=Stability_model%>%
select(5:19)
View(Y)
z=Y%>%
select(4:18)
ggpairs(Y)
res <- cor(Stability_model)
res <- cor(Y)
Stability_model=Data%>%
select(-Direction,-Variety,-Year_CN,-Year_Bulk,)%>%
na.omit()%>%
group_by(Treatment,Block,Year_Stability)%>%
summarise(Stability= mean(Stability),bulk=mean(Bulk_Density),TotalOM=mean(TotalOM),TotalN=mean(TotalN),CN= mean(CN),Cmin=mean(Cmin),`Cmin%`=mean(`Cmin%`), NH4=mean(NH4), NO3= mean(NO3), Nmin_Drysoil=mean(Nmin),`Nmin%`=mean(`Nmin%`), humidity=mean(humidity), F_Mechanical=mean(`F_Mechanical actions`), soiltx=mean(DG_soilTx),`Stone:soil`=mean(`Stone:soil`) )
View(Stability_model)
View(Stability_model)
Y=Stability_model%>%
select(4:18)
View(Y)
res <- cor(Stability_model)
Y=Stability_model%>%
select(-Treatment,-Block,Y-ear_Stability)
Y=Stability_model%>%
select(-Treatment,-Block,-Year_Stability)
View(Y)
Y$Treatment=as.character(Y$Treatment)
Y$Block=as.character(Y$Block)
View(Y)
Z=Y%>%
select(3:17)
res <- cor(X)
Corelation<- cor(X)
Corelation
View(Corelation)
View(Corelation)
ggpairs(X)
install.packages("Hmisc")
library(Hmisc)
library(Hmisc)
res2 <- rcorr(as.matrix(X))
View(res2)
View(res2)
res2
Table(res2)
table=Table(res2)
View(res2)
View(res2)
res2$r
correlation = res2$r
View(correlation)
correlation = res2$p
correlation = res2$P
View(Corelation)
View(correlation)
correlation = res2$r
correlation = res2$r
View(Corelation)
View(correlation)
flattenCorrMatrix(res2$r, res2$P)
data.frame(
row = rownames(cormat)[row(cormat)[ut]],
column = rownames(cormat)[col(cormat)[ut]],
cor  =(cormat)[ut],
p = pmat[ut]
)
data.frame(
row = rownames(cormat)[row(cormat)[ut]],
column = rownames(cormat)[col(cormat)[ut]],
cor  =(cormat)[ut],
p = pmat[ut]
)
corelation=(res2$r, res2$P)
library(Hmisc)
flattenCorrMatrix <- function(cormat, pmat) {
ut <- upper.tri(cormat)
data.frame(
row = rownames(cormat)[row(cormat)[ut]],
column = rownames(cormat)[col(cormat)[ut]],
cor  =(cormat)[ut],
p = pmat[ut]
)
}
flattenCorrMatrix(res2$r, res2$P)
Corelation=flattenCorrMatrix(res2$r, res2$P)
View(Corelation)
install.packages("corrplot")
library(corrplot)
function (..., na.last = TRUE, decreasing = FALSE, method = c("auto",
"shell", "radix"))
corrplot(res2, type = "upper", order = "hclust",
tl.col = "black", tl.srt = 45)
{
z <- list(...)
decreasing <- as.logical(decreasing)
if (length(z) == 1L && is.numeric(x <- z[[1L]]) && !is.object(x) &&
length(x) > 0) {
if (.Internal(sorted_fpass(x, decreasing, na.last)))
return(seq_along(x))
}
method <- match.arg(method)
if (any(vapply(z, is.object, logical(1L)))) {
z <- lapply(z, function(x) if (is.object(x))
as.vector(xtfrm(x))
else x)
return(do.call("order", c(z, list(na.last = na.last,
decreasing = decreasing, method = method))))
}
if (method == "auto") {
useRadix <- all(vapply(z, function(x) {
(is.numeric(x) || is.factor(x) || is.logical(x)) &&
is.integer(length(x))
}, logical(1L)))
method <- if (useRadix)
"radix"
else "shell"
}
if (method != "radix" && !is.na(na.last)) {
if (length(decreasing) > 1L)
stop("'decreasing' of length > 1 is only for method = \"radix\"")
return(.Internal(order(na.last, decreasing, ...)))
}
if (method == "radix") {
decreasing <- rep_len(as.logical(decreasing), length(z))
return(.Internal(radixsort(na.last, decreasing, FALSE,
TRUE, ...)))
}
if (any(diff((l.z <- lengths(z)) != 0L)))
stop("argument lengths differ")
na <- vapply(z, is.na, rep.int(NA, l.z[1L]))
ok <- if (is.matrix(na))
rowSums(na) == 0L
else !any(na)
if (all(!ok))
return(integer())
z[[1L]][!ok] <- NA
ans <- do.call("order", c(z, list(decreasing = decreasing)))
ans[ok[ans]]
}
library(corrplot)
corrplot(res2, type = "upper", order = "hclust",
tl.col = "black", tl.srt = 45)
Corrlation_test=flattenCorrMatrix(res2$r, res2$P)
Stability_model=Data%>%
select(-Direction,-Variety,-Year_CN,-Year_Bulk,)%>%
na.omit()%>%
group_by(Treatment,Block,Year_Stability)%>%
summarise(Stability= mean(Stability),bulk=mean(Bulk_Density),TotalOM=mean(TotalOM),TotalN=mean(TotalN),CN= mean(CN),Cmin=mean(Cmin),`Cmin%`=mean(`Cmin%`), NH4=mean(NH4), NO3= mean(NO3), Nmin_Drysoil=mean(Nmin),`Nmin%`=mean(`Nmin%`), humidity=mean(humidity), F_Mechanical=mean(`F_Mechanical actions`), soiltx=mean(DG_soilTx),`Stone:soil`=mean(`Stone:soil`) )
View(Stability_model)
View(Stability_model)
Stability_model=Data%>%
select(-Direction,-Variety,-Year_CN,-Year_Bulk,)%>%
na.omit()%>%
group_by(Treatment,Block,Year_Stability,Depth)%>%
summarise(Stability= mean(Stability),bulk=mean(Bulk_Density),TotalOM=mean(TotalOM),TotalN=mean(TotalN),CN= mean(CN),Cmin=mean(Cmin),`Cmin%`=mean(`Cmin%`), NH4=mean(NH4), NO3= mean(NO3), Nmin_Drysoil=mean(Nmin),`Nmin%`=mean(`Nmin%`), humidity=mean(humidity), F_Mechanical=mean(`F_Mechanical actions`), soiltx=mean(DG_soilTx),`Stone:soil`=mean(`Stone:soil`) )
View(Stability_model)
View(Stability_model)
str(Stability_model)
Stb_1=lm(Stability~ Treatment+Block+Year_Stability+Depth+ TotalOM +TotalN+CN+Cmin+`Cmin%`+NO3+NH4+Nmin_Drysoil+`Nmin%`+humidity+`F_Mechanical actions`+soiltx+`Stone:soil`, data=Stability_model)
Stb_1=lm(Stability~ Treatment+Block+Year_Stability+Depth+ TotalOM +TotalN+CN+Cmin+`Cmin%`+NO3+NH4+Nmin_Drysoil+`Nmin%`+humidity+F_Mechanical+soiltx+`Stone:soil`, data=Stability_model)
AIC_Stb_1=step(Stb_1,direction="both")
Stb_2=lm(Stability ~ Treatment + Block + Year_Stability + TotalN + CN +
Cmin + NO3 + NH4 + Nmin_Drysoil + `Nmin%` + humidity, data=Stability_model)
drop1(Stb_2,.~.,test="F")
summary(Stb_2)
Stability_model$Stb_2=Stb_2 $residuals
ks.test(Stability_model$Stb_2,"pnorm",mean=0,sd=sd(Stability_model$Stb_2))
shapiro.test(Stability_model$Stb_2)
bptest(Stb_2)
library(readr)
library(agricolae)
library(ggplot2)
library(tidyverse)
library(cowplot)
library(GGally)
library(ggpatern)
bptest(Stb_2)
bptest(Stb_2)
library(lmtest)
bptest(Stb_2)
Stb_1=lm(Stability~ Treatment+Block+Year_Stability+Depth+ TotalOM +TotalN+CN+Cmin+`Cmin%`+NO3+NH4+Nmin_Drysoil+`Nmin%`+humidity+F_Mechanical+soiltx+`Stone:soil`, data=Stb)
Stb_1=lm(Stability~ Treatment+Block+Year_Stability+TotalOM +TotalN+CN+Cmin+`Cmin%`+NO3+NH4+Nmin_Drysoil+`Nmin%`+humidity+F_Mechanical+soiltx+`Stone:soil`, data=Stb)
str(Stb)
Data <- read_csv("SALSADataset.csv", col_types = cols(Treatment = col_factor(levels = c())))%>%
select(-Direction)
na.omit()
Data <- read_csv("SALSADataset.csv", col_types = cols(Treatment = col_factor(levels = c())))%>%
select(-Direction)%>%
na.omit()
View(Data)
Stb_1=lm(Stability~ Treatment+Block+Year_Stability+TotalOM +TotalN+CN+Cmin+`Cmin%`+NO3+NH4+Nmin_Drysoil+`Nmin%`+humidity+F_Mechanical+soiltx+`Stone:soil`, data=Data)
str(Data)
Stb_1=lm(Stability~ Treatment+Block+Year_Stability+TotalOM +TotalN+CN+Cmin+`Cmin%`+NO3+NH4+Nmin_Drysoil+`Nmin%`+humidity+F_Mechanical+soiltx+`Stone:soil`, data=Data)
Stb_1=lm(Stability~ Treatment+Block+Year_Stability+TotalOM +TotalN+CN+Cmin+`Cmin%`+NO3+NH4+Nmin+`Nmin%`+humidity+F_Mechanical+soiltx+`Stone:soil`, data=Data)
Stb_1=lm(Stability~ Treatment+Block+Year_Stability+TotalOM +TotalN+CN+Cmin+`Cmin%`+NO3+NH4+Nmin+`Nmin%`+humidity+`F_Mechanical actions`+soiltx+`Stone:soil`, data=Data)
Stb_1=lm(Stability~ Treatment+Block+Year_Stability+TotalOM +TotalN+CN+Cmin+`Cmin%`+NO3+NH4+Nmin+`Nmin%`+humidity+`F_Mechanical actions`+DG_soilTx+`Stone:soil`, data=Data)
AIC_Stb_1=step(Stb_1,direction="both")
#original dataset
Stb_3=lm(Stability~ Treatment+Block+Year_Stability+TotalOM +TotalN+CN+Cmin+`Cmin%`+NO3+NH4+Nmin+`Nmin%`+humidity+`F_Mechanical actions`+DG_soilTx+`Stone:soil`, data=Data)
AIC_Stb_3=step(Stb_1,direction="both")
Stb_4=Stability ~ Treatment + Block + Year_Stability + TotalOM + TotalN +
CN + `Cmin%` + NO3 + NH4 + Nmin + `Nmin%` + humidity + DG_soilTx
drop1(Stb_4,.~.,test="F")
Stb_4=lm(Stability ~ Treatment + Block + Year_Stability + TotalOM + TotalN +
CN + `Cmin%` + NO3 + NH4 + Nmin + `Nmin%` + humidity + DG_soilTx, data=Data)
drop1(Stb_4,.~.,test="F")
Stability_model$Stb_4=Stb_4 $residuals
ks.test(Stability_model$Stb_4,"pnorm",mean=0,sd=sd(Stability_model$Stb_4))
Stability_model$Stb_4=Stb_4$residuals
Stb_4=lm(Stability ~ Treatment + Block + Year_Stability + TotalOM + TotalN +
CN + `Cmin%` + NO3 + NH4 + Nmin + `Nmin%` + humidity + DG_soilTx, data=Data)
drop1(Stb_4,.~.,test="F")
ks.test(Stability_model$Stb_4,"pnorm",mean=0,sd=sd(Stability_model$Stb_4))
Stability_model$Stb_4=Stb_4 $residuals
anova(Str_Stb)
summary(Stb_2)
str(Stability_model)
Stability_model$Year_Stability=as.factor(Stability_model$Year_Stability)
Stb_1=lm(Stability~ Treatment+Block+Year_Stability+Depth+ TotalOM +TotalN+CN+Cmin+`Cmin%`+NO3+NH4+Nmin_Drysoil+`Nmin%`+humidity+F_Mechanical+soiltx+`Stone:soil`, data=Stability_model)
AIC_Stb_1=step(Stb_1,direction="both")
summary(Stb_2)
Stability_model$Stb_2=Stb_2 $residuals
ks.test(Stability_model$Stb_2,"pnorm",mean=0,sd=sd(Stability_model$Stb_2))
shapiro.test(Stability_model$Stb_2)
bptest(Stb_2)
view(Corrlation_tes)
view(Corrlation_test)
Corrlation_test=flattenCorrMatrix(res2$r, res2$P)%>%
filter(P<=0.05)
Corrlation_test=flattenCorrMatrix(res2$r, res2$P)%>%
filter(p<=0.05)
view(Corrlation_test)
Corrlation_test=flattenCorrMatrix(res2$r, res2$P)%>%
filter(p<=0.05,r>=0.5||r<=-0.5 )
Corrlation_test=flattenCorrMatrix(res2$r, res2$P)%>%
filter(p<=0.05,r>=0.5)
Corrlation_test=flattenCorrMatrix(res2$r, res2$P)%>%
filter(p<=0.05,cor>=0.5)
Corrlation_test=flattenCorrMatrix(res2$r, res2$P)%>%
filter(p<=0.05,cor>=0.5||corr<=-0.5)
view(Corrlation_test)
Corrlation_test=flattenCorrMatrix(res2$r, res2$P)%>%
filter(p<=0.05,cor>=0.5)
view(Corrlation_test)
Corrlation_test=flattenCorrMatrix(res2$r, res2$P)%>%
filter(p<=0.05)
view(Corrlation_test)
Corrlation_test=flattenCorrMatrix(res2$r, res2$P)%>%
filter(p<=0.05,,cor>=0.5,cor<=-0.5)
view(Corrlation_test)
Corrlation_test=flattenCorrMatrix(res2$r, res2$P)%>%
filter(p<=0.05,,cor>=0.5)
Corrlation_test=flattenCorrMatrix(res2$r, res2$P)%>%
filter(p<=0.05,cor>=0.5,cor<=-0.5)
view(Corrlation_test)
Corrlation_test=flattenCorrMatrix(res2$r, res2$P)%>%
filter(p<=0.05,cor>=0.5||cor<=-0.5)
view(Corrlation_test)
Corrlation_test=flattenCorrMatrix(res2$r, res2$P)%>%
filter(p<=0.05,cor<=-0.5)
view(Corrlation_test)
Corrlation_test2=flattenCorrMatrix(res2$r, res2$P)%>%
filter(p<=0.05,cor>=0.5)
Correlation=rbind(Corrlation_test1,Corrlation_test2)%>%
arrange(cor)
Corrlation_test1=flattenCorrMatrix(res2$r, res2$P)%>%
filter(p<=0.05,cor<=-0.5)
Corrlation_test2=flattenCorrMatrix(res2$r, res2$P)%>%
filter(p<=0.05,cor>=0.5)
Correlation=rbind(Corrlation_test1,Corrlation_test2)%>%
arrange(cor)
view(Correlation)
str(correlation$P)
str(correlation)
Correlation=rbind(Corrlation_test1,Corrlation_test2)%>%
select(-P)%>%
arrange(cor)%>%
mutate(`P-value<0.05`= significant)
Correlation=rbind(Corrlation_test1,Corrlation_test2)%>%
select(-p)%>%
arrange(cor)%>%
mutate(`P-value<0.05`= significant)
Correlation=rbind(Corrlation_test1,Corrlation_test2)%>%
select(-p)%>%
arrange(cor)%>%
mutate(`P-value<0.05`= "significant")
view(Correlation)
write.csv(Correlation)
write.csv(Correlation,"C:/Users/melis/OneDrive - Universiti Putra Malaysia/Documents/GitHub/23_JRL_towardsagroecology/Correlation.csv",row.names=FALSE)
